{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import invariant from'invariant';import*as CapabilityUtils from\"./WebCapabilityUtils\";import{CameraTypeToFacingMode,ImageTypeFormat,MinimumConstraints}from\"./WebConstants\";import{requestUserMediaAsync}from\"./WebUserMediaManager\";export function getImageSize(videoWidth,videoHeight,scale){var width=videoWidth*scale;var ratio=videoWidth/width;var height=videoHeight/ratio;return{width:width,height:height};}export function toDataURL(canvas,imageType,quality){var types=['png','jpg'];invariant(types.includes(imageType),`expo-camera: ${imageType} is not a valid ImageType. Expected a string from: ${types.join(', ')}`);var format=ImageTypeFormat[imageType];if(imageType==='jpg'){invariant(quality<=1&&quality>=0,`expo-camera: ${quality} is not a valid image quality. Expected a number from 0...1`);return canvas.toDataURL(format,quality);}else{return canvas.toDataURL(format);}}export function hasValidConstraints(preferredCameraType,width,height){return preferredCameraType!==undefined&&width!==undefined&&height!==undefined;}function ensureCameraPictureOptions(config){var captureOptions={scale:1,imageType:'png',isImageMirror:false};for(var key in config){if(key in config&&config[key]!==undefined&&key in captureOptions){captureOptions[key]=config[key];}}return captureOptions;}var DEFAULT_QUALITY=0.92;export function captureImageData(video){var pictureOptions=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!video||video.readyState!==video.HAVE_ENOUGH_DATA){return null;}var canvas=captureImageContext(video,pictureOptions);var context=canvas.getContext('2d',{alpha:false});if(!context||!canvas.width||!canvas.height){return null;}var imageData=context.getImageData(0,0,canvas.width,canvas.height);return imageData;}export function captureImageContext(video,_ref){var _ref$scale=_ref.scale,scale=_ref$scale===void 0?1:_ref$scale,_ref$isImageMirror=_ref.isImageMirror,isImageMirror=_ref$isImageMirror===void 0?false:_ref$isImageMirror;var videoWidth=video.videoWidth,videoHeight=video.videoHeight;var _getImageSize=getImageSize(videoWidth,videoHeight,scale),width=_getImageSize.width,height=_getImageSize.height;var canvas=document.createElement('canvas');canvas.width=width;canvas.height=height;var context=canvas.getContext('2d',{alpha:false});if(!context){throw new Error('Context is not defined');}if(isImageMirror){context.setTransform(-1,0,0,1,canvas.width,0);}context.drawImage(video,0,0,width,height);return canvas;}export function captureImage(video,pictureOptions){var config=ensureCameraPictureOptions(pictureOptions);var canvas=captureImageContext(video,config);var imageType=config.imageType,_config$quality=config.quality,quality=_config$quality===void 0?DEFAULT_QUALITY:_config$quality;return toDataURL(canvas,imageType,quality);}function getSupportedConstraints(){if(navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints){return navigator.mediaDevices.getSupportedConstraints();}return null;}export function getIdealConstraints(preferredCameraType,width,height){var preferredConstraints={audio:false,video:{}};if(hasValidConstraints(preferredCameraType,width,height)){return MinimumConstraints;}var supports=getSupportedConstraints();if(!supports||!supports.facingMode||!supports.width||!supports.height){return MinimumConstraints;}var types=['front','back'];if(preferredCameraType&&types.includes(preferredCameraType)){var facingMode=CameraTypeToFacingMode[preferredCameraType];if(isWebKit()){var key=facingMode==='user'?'exact':'ideal';preferredConstraints.video.facingMode=_defineProperty({},key,facingMode);}else{preferredConstraints.video.facingMode={ideal:CameraTypeToFacingMode[preferredCameraType]};}}if(isMediaTrackConstraints(preferredConstraints.video)){preferredConstraints.video.width=width;preferredConstraints.video.height=height;}return preferredConstraints;}function isMediaTrackConstraints(input){return input&&typeof input.video!=='boolean';}export function getPreferredStreamDevice(_x,_x2,_x3){return _getPreferredStreamDevice.apply(this,arguments);}function _getPreferredStreamDevice(){_getPreferredStreamDevice=_asyncToGenerator(function*(preferredCameraType,preferredWidth,preferredHeight){try{return yield getStreamDevice(preferredCameraType,preferredWidth,preferredHeight);}catch(error){if(error instanceof OverconstrainedError&&error.constraint==='facingMode'){var nextCameraType=preferredCameraType==='back'?'front':'back';return yield getStreamDevice(nextCameraType,preferredWidth,preferredHeight);}throw error;}});return _getPreferredStreamDevice.apply(this,arguments);}export function getStreamDevice(_x4,_x5,_x6){return _getStreamDevice.apply(this,arguments);}function _getStreamDevice(){_getStreamDevice=_asyncToGenerator(function*(preferredCameraType,preferredWidth,preferredHeight){var constraints=getIdealConstraints(preferredCameraType,preferredWidth,preferredHeight);var stream=yield requestUserMediaAsync(constraints);return stream;});return _getStreamDevice.apply(this,arguments);}export function isWebKit(){return /WebKit/.test(navigator.userAgent)&&!/Edg/.test(navigator.userAgent);}export function compareStreams(a,b){if(!a||!b){return false;}var settingsA=a.getTracks()[0].getSettings();var settingsB=b.getTracks()[0].getSettings();return settingsA.deviceId===settingsB.deviceId;}export function capture(video,settings,config){var base64=captureImage(video,config);var capturedPicture={uri:base64,base64:base64,width:0,height:0};if(settings){var _settings$width=settings.width,width=_settings$width===void 0?0:_settings$width,_settings$height=settings.height,height=_settings$height===void 0?0:_settings$height;capturedPicture.width=width;capturedPicture.height=height;capturedPicture.exif=settings;}if(config.onPictureSaved){config.onPictureSaved(capturedPicture);}return capturedPicture;}export function syncTrackCapabilities(_x7,_x8){return _syncTrackCapabilities.apply(this,arguments);}function _syncTrackCapabilities(){_syncTrackCapabilities=_asyncToGenerator(function*(cameraType,stream){var settings=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(stream!=null&&stream.getVideoTracks){yield Promise.all(stream.getVideoTracks().map(function(track){return onCapabilitiesReady(cameraType,track,settings);}));}});return _syncTrackCapabilities.apply(this,arguments);}function onCapabilitiesReady(_x9,_x10){return _onCapabilitiesReady.apply(this,arguments);}function _onCapabilitiesReady(){_onCapabilitiesReady=_asyncToGenerator(function*(cameraType,track){var settings=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(typeof track.getCapabilities!=='function'){return;}var capabilities=track.getCapabilities();var constraints={};var clampedValues=['exposureCompensation','colorTemperature','iso','brightness','contrast','saturation','sharpness','focusDistance','zoom'];for(var property of clampedValues){if(capabilities[property]){constraints[property]=convertNormalizedSetting(capabilities[property],settings[property]);}}function validatedInternalConstrainedValue(constraintKey,settingsKey,converter){var convertedSetting=converter(settings[settingsKey]);return validatedConstrainedValue({constraintKey:constraintKey,settingsKey:settingsKey,convertedSetting:convertedSetting,capabilities:capabilities,settings:settings,cameraType:cameraType});}if(capabilities.focusMode&&settings.autoFocus!==undefined){constraints.focusMode=validatedInternalConstrainedValue('focusMode','autoFocus',CapabilityUtils.convertAutoFocusJSONToNative);}if(capabilities.torch&&settings.flashMode!==undefined){constraints.torch=validatedInternalConstrainedValue('torch','flashMode',CapabilityUtils.convertFlashModeJSONToNative);}if(capabilities.whiteBalanceMode&&settings.whiteBalance!==undefined){constraints.whiteBalanceMode=validatedInternalConstrainedValue('whiteBalanceMode','whiteBalance',CapabilityUtils.convertWhiteBalanceJSONToNative);}try{yield track.applyConstraints({advanced:[constraints]});}catch(error){if(__DEV__)console.warn('Failed to apply constraints',error);}});return _onCapabilitiesReady.apply(this,arguments);}export function stopMediaStream(stream){if(!stream){return;}if(stream.getAudioTracks){stream.getAudioTracks().forEach(function(track){return track.stop();});}if(stream.getVideoTracks){stream.getVideoTracks().forEach(function(track){return track.stop();});}if(isMediaStreamTrack(stream)){stream.stop();}}export function setVideoSource(video,stream){var _window$URL$createObj;var createObjectURL=(_window$URL$createObj=window.URL.createObjectURL)!=null?_window$URL$createObj:window.webkitURL.createObjectURL;if(typeof video.srcObject!=='undefined'){video.srcObject=stream;}else if(typeof video.mozSrcObject!=='undefined'){video.mozSrcObject=stream;}else if(stream&&createObjectURL){video.src=createObjectURL(stream);}if(!stream){var _window$URL$revokeObj,_ref2,_video$src;var revokeObjectURL=(_window$URL$revokeObj=window.URL.revokeObjectURL)!=null?_window$URL$revokeObj:window.webkitURL.revokeObjectURL;var source=(_ref2=(_video$src=video.src)!=null?_video$src:video.srcObject)!=null?_ref2:video.mozSrcObject;if(revokeObjectURL&&typeof source==='string'){revokeObjectURL(source);}}}export function isCapabilityAvailable(video,keyName){var stream=video.srcObject;if(stream instanceof MediaStream){var _videoTrack$getCapabi;var videoTrack=stream.getVideoTracks()[0];return videoTrack.getCapabilities==null?void 0:(_videoTrack$getCapabi=videoTrack.getCapabilities())==null?void 0:_videoTrack$getCapabi[keyName];}return false;}function isMediaStreamTrack(input){return typeof input.stop==='function';}function convertNormalizedSetting(range,value){if(!value){return;}var converted=convertRange(value,[range.min,range.max]);return Math.min(range.max,Math.max(range.min,converted));}function convertRange(value,r2){var r1=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[0,1];return(value-r1[0])*(r2[1]-r2[0])/(r1[1]-r1[0])+r2[0];}function validatedConstrainedValue(props){var constraintKey=props.constraintKey,settingsKey=props.settingsKey,convertedSetting=props.convertedSetting,capabilities=props.capabilities,settings=props.settings,cameraType=props.cameraType;var setting=settings[settingsKey];if(Array.isArray(capabilities[constraintKey])&&convertedSetting&&!capabilities[constraintKey].includes(convertedSetting)){if(__DEV__){console.warn(` { ${settingsKey}: \"${setting}\" } (converted to \"${convertedSetting}\" in the browser) is not supported for camera type \"${cameraType}\" in your browser. Using the default value instead.`);}return undefined;}return convertedSetting;}","map":{"version":3,"names":["invariant","CapabilityUtils","CameraTypeToFacingMode","ImageTypeFormat","MinimumConstraints","requestUserMediaAsync","getImageSize","videoWidth","videoHeight","scale","width","ratio","height","toDataURL","canvas","imageType","quality","types","includes","join","format","hasValidConstraints","preferredCameraType","undefined","ensureCameraPictureOptions","config","captureOptions","isImageMirror","key","DEFAULT_QUALITY","captureImageData","video","pictureOptions","arguments","length","readyState","HAVE_ENOUGH_DATA","captureImageContext","context","getContext","alpha","imageData","getImageData","_ref","_ref$scale","_ref$isImageMirror","_getImageSize","document","createElement","Error","setTransform","drawImage","captureImage","_config$quality","getSupportedConstraints","navigator","mediaDevices","getIdealConstraints","preferredConstraints","audio","supports","facingMode","isWebKit","_defineProperty","ideal","isMediaTrackConstraints","input","getPreferredStreamDevice","_x","_x2","_x3","_getPreferredStreamDevice","apply","_asyncToGenerator","preferredWidth","preferredHeight","getStreamDevice","error","OverconstrainedError","constraint","nextCameraType","_x4","_x5","_x6","_getStreamDevice","constraints","stream","test","userAgent","compareStreams","a","b","settingsA","getTracks","getSettings","settingsB","deviceId","capture","settings","base64","capturedPicture","uri","_settings$width","_settings$height","exif","onPictureSaved","syncTrackCapabilities","_x7","_x8","_syncTrackCapabilities","cameraType","getVideoTracks","Promise","all","map","track","onCapabilitiesReady","_x9","_x10","_onCapabilitiesReady","getCapabilities","capabilities","clampedValues","property","convertNormalizedSetting","validatedInternalConstrainedValue","constraintKey","settingsKey","converter","convertedSetting","validatedConstrainedValue","focusMode","autoFocus","convertAutoFocusJSONToNative","torch","flashMode","convertFlashModeJSONToNative","whiteBalanceMode","whiteBalance","convertWhiteBalanceJSONToNative","applyConstraints","advanced","__DEV__","console","warn","stopMediaStream","getAudioTracks","forEach","stop","isMediaStreamTrack","setVideoSource","_window$URL$createObj","createObjectURL","window","URL","webkitURL","srcObject","mozSrcObject","src","_window$URL$revokeObj","_ref2","_video$src","revokeObjectURL","source","isCapabilityAvailable","keyName","MediaStream","_videoTrack$getCapabi","videoTrack","range","value","converted","convertRange","min","max","Math","r2","r1","props","setting","Array","isArray"],"sources":["/home/runner/workspace/node_modules/expo-camera/src/web/WebCameraUtils.ts"],"sourcesContent":["/* eslint-env browser */\nimport invariant from 'invariant';\n\nimport * as CapabilityUtils from './WebCapabilityUtils';\nimport { CameraTypeToFacingMode, ImageTypeFormat, MinimumConstraints } from './WebConstants';\nimport { requestUserMediaAsync } from './WebUserMediaManager';\nimport {\n  CameraType,\n  CameraCapturedPicture,\n  ImageSize,\n  ImageType,\n  WebCameraSettings,\n  CameraPictureOptions,\n} from '../Camera.types';\n\ninterface ConstrainLongRange {\n  max?: number;\n  min?: number;\n  exact?: number;\n  ideal?: number;\n}\n\nexport function getImageSize(videoWidth: number, videoHeight: number, scale: number): ImageSize {\n  const width = videoWidth * scale;\n  const ratio = videoWidth / width;\n  const height = videoHeight / ratio;\n\n  return {\n    width,\n    height,\n  };\n}\n\nexport function toDataURL(\n  canvas: HTMLCanvasElement,\n  imageType: ImageType,\n  quality: number\n): string {\n  const types = ['png', 'jpg'];\n  invariant(\n    types.includes(imageType),\n    `expo-camera: ${imageType} is not a valid ImageType. Expected a string from: ${types.join(', ')}`\n  );\n\n  const format = ImageTypeFormat[imageType];\n  if (imageType === 'jpg') {\n    invariant(\n      quality <= 1 && quality >= 0,\n      `expo-camera: ${quality} is not a valid image quality. Expected a number from 0...1`\n    );\n    return canvas.toDataURL(format, quality);\n  } else {\n    return canvas.toDataURL(format);\n  }\n}\n\nexport function hasValidConstraints(\n  preferredCameraType?: CameraType,\n  width?: number | ConstrainLongRange,\n  height?: number | ConstrainLongRange\n): boolean {\n  return preferredCameraType !== undefined && width !== undefined && height !== undefined;\n}\n\nfunction ensureCameraPictureOptions(config: CameraPictureOptions): CameraPictureOptions {\n  const captureOptions = {\n    scale: 1,\n    imageType: 'png' as ImageType,\n    isImageMirror: false,\n  };\n\n  for (const key in config) {\n    if (key in config && config[key] !== undefined && key in captureOptions) {\n      captureOptions[key] = config[key];\n    }\n  }\n  return captureOptions;\n}\n\nconst DEFAULT_QUALITY = 0.92;\n\nexport function captureImageData(\n  video: HTMLVideoElement | null,\n  pictureOptions: Pick<CameraPictureOptions, 'scale' | 'isImageMirror'> = {}\n): ImageData | null {\n  if (!video || video.readyState !== video.HAVE_ENOUGH_DATA) {\n    return null;\n  }\n  const canvas = captureImageContext(video, pictureOptions);\n\n  const context = canvas.getContext('2d', { alpha: false });\n  if (!context || !canvas.width || !canvas.height) {\n    return null;\n  }\n\n  const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n  return imageData;\n}\n\nexport function captureImageContext(\n  video: HTMLVideoElement,\n  { scale = 1, isImageMirror = false }: Pick<CameraPictureOptions, 'scale' | 'isImageMirror'>\n): HTMLCanvasElement {\n  const { videoWidth, videoHeight } = video;\n  const { width, height } = getImageSize(videoWidth, videoHeight, scale!);\n\n  // Build the canvas size and draw the camera image to the context from video\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const context = canvas.getContext('2d', { alpha: false });\n\n  if (!context) {\n    // Should never be called\n    throw new Error('Context is not defined');\n  }\n  // sharp image details\n  // context.imageSmoothingEnabled = false;\n\n  // Flip horizontally (as css transform: rotateY(180deg))\n  if (isImageMirror) {\n    context.setTransform(-1, 0, 0, 1, canvas.width, 0);\n  }\n\n  context.drawImage(video, 0, 0, width, height);\n\n  return canvas;\n}\n\nexport function captureImage(\n  video: HTMLVideoElement,\n  pictureOptions: CameraPictureOptions\n): string {\n  const config = ensureCameraPictureOptions(pictureOptions);\n  const canvas = captureImageContext(video, config);\n  const { imageType, quality = DEFAULT_QUALITY } = config;\n  return toDataURL(canvas, imageType!, quality);\n}\n\nfunction getSupportedConstraints(): MediaTrackSupportedConstraints | null {\n  if (navigator.mediaDevices && navigator.mediaDevices.getSupportedConstraints) {\n    return navigator.mediaDevices.getSupportedConstraints();\n  }\n  return null;\n}\n\nexport function getIdealConstraints(\n  preferredCameraType: CameraType,\n  width?: number | ConstrainLongRange,\n  height?: number | ConstrainLongRange\n): MediaStreamConstraints {\n  const preferredConstraints: MediaStreamConstraints = {\n    audio: false,\n    video: {},\n  };\n\n  if (hasValidConstraints(preferredCameraType, width, height)) {\n    return MinimumConstraints;\n  }\n\n  const supports = getSupportedConstraints();\n  // TODO(Bacon): Test this\n  if (!supports || !supports.facingMode || !supports.width || !supports.height) {\n    return MinimumConstraints;\n  }\n  const types = ['front', 'back'];\n  if (preferredCameraType && types.includes(preferredCameraType)) {\n    const facingMode = CameraTypeToFacingMode[preferredCameraType];\n    if (isWebKit()) {\n      const key = facingMode === 'user' ? 'exact' : 'ideal';\n      (preferredConstraints.video as MediaTrackConstraints).facingMode = {\n        [key]: facingMode,\n      };\n    } else {\n      (preferredConstraints.video as MediaTrackConstraints).facingMode = {\n        ideal: CameraTypeToFacingMode[preferredCameraType],\n      };\n    }\n  }\n\n  if (isMediaTrackConstraints(preferredConstraints.video)) {\n    preferredConstraints.video.width = width;\n    preferredConstraints.video.height = height;\n  }\n\n  return preferredConstraints;\n}\n\nfunction isMediaTrackConstraints(input: any): input is MediaTrackConstraints {\n  return input && typeof input.video !== 'boolean';\n}\n\n/**\n * Invoke getStreamDevice a second time with the opposing camera type if the preferred type cannot be retrieved.\n *\n * @param preferredCameraType\n * @param preferredWidth\n * @param preferredHeight\n */\nexport async function getPreferredStreamDevice(\n  preferredCameraType: CameraType,\n  preferredWidth?: number | ConstrainLongRange,\n  preferredHeight?: number | ConstrainLongRange\n): Promise<MediaStream> {\n  try {\n    return await getStreamDevice(preferredCameraType, preferredWidth, preferredHeight);\n  } catch (error) {\n    // A hack on desktop browsers to ensure any camera is used.\n    // eslint-disable-next-line no-undef\n    if (error instanceof OverconstrainedError && error.constraint === 'facingMode') {\n      const nextCameraType = preferredCameraType === 'back' ? 'front' : 'back';\n      return await getStreamDevice(nextCameraType, preferredWidth, preferredHeight);\n    }\n    throw error;\n  }\n}\n\nexport async function getStreamDevice(\n  preferredCameraType: CameraType,\n  preferredWidth?: number | ConstrainLongRange,\n  preferredHeight?: number | ConstrainLongRange\n): Promise<MediaStream> {\n  const constraints: MediaStreamConstraints = getIdealConstraints(\n    preferredCameraType,\n    preferredWidth,\n    preferredHeight\n  );\n  const stream: MediaStream = await requestUserMediaAsync(constraints);\n  return stream;\n}\n\nexport function isWebKit(): boolean {\n  return /WebKit/.test(navigator.userAgent) && !/Edg/.test(navigator.userAgent);\n}\n\nexport function compareStreams(a: MediaStream | null, b: MediaStream | null): boolean {\n  if (!a || !b) {\n    return false;\n  }\n  const settingsA = a.getTracks()[0].getSettings();\n  const settingsB = b.getTracks()[0].getSettings();\n  return settingsA.deviceId === settingsB.deviceId;\n}\n\nexport function capture(\n  video: HTMLVideoElement,\n  settings: MediaTrackSettings,\n  config: CameraPictureOptions\n): CameraCapturedPicture {\n  const base64 = captureImage(video, config);\n\n  const capturedPicture: CameraCapturedPicture = {\n    uri: base64,\n    base64,\n    width: 0,\n    height: 0,\n  };\n\n  if (settings) {\n    const { width = 0, height = 0 } = settings;\n    capturedPicture.width = width;\n    capturedPicture.height = height;\n    capturedPicture.exif = settings;\n  }\n\n  if (config.onPictureSaved) {\n    config.onPictureSaved(capturedPicture);\n  }\n  return capturedPicture;\n}\n\nexport async function syncTrackCapabilities(\n  cameraType: CameraType,\n  stream: MediaStream | null,\n  settings: WebCameraSettings = {}\n): Promise<void> {\n  if (stream?.getVideoTracks) {\n    await Promise.all(\n      stream.getVideoTracks().map((track) => onCapabilitiesReady(cameraType, track, settings))\n    );\n  }\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints\nasync function onCapabilitiesReady(\n  cameraType: CameraType,\n  track: MediaStreamTrack,\n  settings: WebCameraSettings = {}\n): Promise<void> {\n  if (typeof track.getCapabilities !== 'function') {\n    return;\n  }\n\n  const capabilities = track.getCapabilities();\n\n  // Create an empty object because if you set a constraint that isn't available an error will be thrown.\n  const constraints: MediaTrackConstraintSet = {};\n\n  // TODO(Bacon): Add `pointsOfInterest` support\n  const clampedValues = [\n    'exposureCompensation',\n    'colorTemperature',\n    'iso',\n    'brightness',\n    'contrast',\n    'saturation',\n    'sharpness',\n    'focusDistance',\n    'zoom',\n  ];\n\n  for (const property of clampedValues) {\n    if (capabilities[property]) {\n      constraints[property] = convertNormalizedSetting(capabilities[property], settings[property]);\n    }\n  }\n\n  function validatedInternalConstrainedValue<IConvertedType>(\n    constraintKey: string,\n    settingsKey: string,\n    converter: (settingValue: any) => IConvertedType\n  ) {\n    const convertedSetting = converter(settings[settingsKey]);\n    return validatedConstrainedValue({\n      constraintKey,\n      settingsKey,\n      convertedSetting,\n      capabilities,\n      settings,\n      cameraType,\n    });\n  }\n\n  if (capabilities.focusMode && settings.autoFocus !== undefined) {\n    constraints.focusMode = validatedInternalConstrainedValue<MediaTrackConstraintSet['focusMode']>(\n      'focusMode',\n      'autoFocus',\n      CapabilityUtils.convertAutoFocusJSONToNative\n    );\n  }\n\n  if (capabilities.torch && settings.flashMode !== undefined) {\n    constraints.torch = validatedInternalConstrainedValue<MediaTrackConstraintSet['torch']>(\n      'torch',\n      'flashMode',\n      CapabilityUtils.convertFlashModeJSONToNative\n    );\n  }\n\n  if (capabilities.whiteBalanceMode && settings.whiteBalance !== undefined) {\n    constraints.whiteBalanceMode = validatedInternalConstrainedValue<\n      MediaTrackConstraintSet['whiteBalanceMode']\n    >('whiteBalanceMode', 'whiteBalance', CapabilityUtils.convertWhiteBalanceJSONToNative);\n  }\n\n  try {\n    await track.applyConstraints({ advanced: [constraints] });\n  } catch (error) {\n    if (__DEV__) console.warn('Failed to apply constraints', error);\n  }\n}\n\nexport function stopMediaStream(stream: MediaStream | null) {\n  if (!stream) {\n    return;\n  }\n  if (stream.getAudioTracks) {\n    stream.getAudioTracks().forEach((track) => track.stop());\n  }\n  if (stream.getVideoTracks) {\n    stream.getVideoTracks().forEach((track) => track.stop());\n  }\n  if (isMediaStreamTrack(stream)) {\n    stream.stop();\n  }\n}\n\nexport function setVideoSource(\n  video: HTMLVideoElement,\n  stream: MediaStream | MediaSource | Blob | null\n): void {\n  const createObjectURL = window.URL.createObjectURL ?? window.webkitURL.createObjectURL;\n\n  if (typeof video.srcObject !== 'undefined') {\n    video.srcObject = stream;\n  } else if (typeof (video as any).mozSrcObject !== 'undefined') {\n    (video as any).mozSrcObject = stream;\n  } else if (stream && createObjectURL) {\n    video.src = createObjectURL(stream as MediaSource | Blob);\n  }\n\n  if (!stream) {\n    const revokeObjectURL = window.URL.revokeObjectURL ?? window.webkitURL.revokeObjectURL;\n    const source = video.src ?? video.srcObject ?? (video as any).mozSrcObject;\n    if (revokeObjectURL && typeof source === 'string') {\n      revokeObjectURL(source);\n    }\n  }\n}\n\nexport function isCapabilityAvailable(video: HTMLVideoElement, keyName: string): boolean {\n  const stream = video.srcObject;\n\n  if (stream instanceof MediaStream) {\n    const videoTrack = stream.getVideoTracks()[0];\n    return videoTrack.getCapabilities?.()?.[keyName];\n  }\n\n  return false;\n}\n\nfunction isMediaStreamTrack(input: any): input is MediaStreamTrack {\n  return typeof input.stop === 'function';\n}\n\nfunction convertNormalizedSetting(range: MediaSettingsRange, value?: number): number | undefined {\n  if (!value) {\n    return;\n  }\n  // convert the normalized incoming setting to the native camera zoom range\n  const converted = convertRange(value, [range.min, range.max]);\n  // clamp value so we don't get an error\n  return Math.min(range.max, Math.max(range.min, converted));\n}\n\nfunction convertRange(value: number, r2: number[], r1: number[] = [0, 1]): number {\n  return ((value - r1[0]) * (r2[1] - r2[0])) / (r1[1] - r1[0]) + r2[0];\n}\n\nfunction validatedConstrainedValue<T>(props: {\n  constraintKey: string;\n  settingsKey: string;\n  convertedSetting: T;\n  capabilities: MediaTrackCapabilities;\n  settings: WebCameraSettings;\n  cameraType: string;\n}): T | undefined {\n  const { constraintKey, settingsKey, convertedSetting, capabilities, settings, cameraType } =\n    props;\n  const setting = settings[settingsKey];\n  if (\n    Array.isArray(capabilities[constraintKey]) &&\n    convertedSetting &&\n    !capabilities[constraintKey].includes(convertedSetting)\n  ) {\n    if (__DEV__) {\n      // Only warn in dev mode.\n      console.warn(\n        ` { ${settingsKey}: \"${setting}\" } (converted to \"${convertedSetting}\" in the browser) is not supported for camera type \"${cameraType}\" in your browser. Using the default value instead.`\n      );\n    }\n    return undefined;\n  }\n  return convertedSetting;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}