{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useEffect}from'react';import View from\"react-native-web/dist/exports/View\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import FlatList from\"react-native-web/dist/exports/FlatList\";import Text from\"react-native-web/dist/exports/Text\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import{Searchbar,Card,Title,Paragraph,Button,Chip}from'react-native-paper';import{Feather}from'@expo/vector-icons';import useEvent from\"../../hooks/useEvent\";import GateSelector from\"../../components/GateSelector\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";var GateSelectionScreen=function GateSelectionScreen(_ref){var navigation=_ref.navigation,route=_ref.route;var _useEvent=useEvent(),selectedEvent=_useEvent.selectedEvent,gates=_useEvent.gates,loadGates=_useEvent.loadGates,selectGate=_useEvent.selectGate,isLoading=_useEvent.isLoading;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchQuery=_useState2[0],setSearchQuery=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),filteredGates=_useState4[0],setFilteredGates=_useState4[1];useEffect(function(){if(selectedEvent){loadGates(selectedEvent.id);}else{navigation.navigate('EventSelection');}},[selectedEvent]);useEffect(function(){if(gates){filterGates();}},[gates,searchQuery]);var filterGates=function filterGates(){if(!searchQuery.trim()){setFilteredGates(gates);}else{var filtered=gates.filter(function(gate){return gate.name.toLowerCase().includes(searchQuery.toLowerCase())||gate.identifier.toLowerCase().includes(searchQuery.toLowerCase());});setFilteredGates(filtered);}};var handleSelectGate=function(){var _ref2=_asyncToGenerator(function*(gate){if(!gate.isEnabled){return;}var success=yield selectGate(gate);if(success){navigation.navigate('Scanner');}});return function handleSelectGate(_x){return _ref2.apply(this,arguments);};}();if(!selectedEvent){return _jsxs(View,{style:styles.centerContainer,children:[_jsx(Feather,{name:\"alert-circle\",size:50,color:\"#e74c3c\"}),_jsx(Text,{style:styles.errorText,children:\"No event selected\"}),_jsx(Button,{mode:\"contained\",onPress:function onPress(){return navigation.navigate('EventSelection');},style:styles.button,children:\"Select Event\"})]});}if(isLoading){return _jsxs(View,{style:styles.centerContainer,children:[_jsx(ActivityIndicator,{size:\"large\",color:\"#2c3e50\"}),_jsx(Text,{style:styles.loadingText,children:\"Loading gates...\"})]});}return _jsxs(View,{style:styles.container,children:[_jsx(Card,{style:styles.eventCard,children:_jsxs(Card.Content,{children:[_jsx(Title,{style:styles.eventName,children:selectedEvent.name}),_jsx(Paragraph,{children:new Date(selectedEvent.date).toLocaleDateString()})]})}),_jsx(Searchbar,{placeholder:\"Search gates...\",onChangeText:setSearchQuery,value:searchQuery,style:styles.searchBar}),gates.length===0?_jsxs(View,{style:styles.centerContainer,children:[_jsx(Feather,{name:\"map-pin\",size:50,color:\"#95a5a6\"}),_jsx(Text,{style:styles.emptyText,children:\"No gates available for this event\"}),_jsx(Button,{mode:\"outlined\",onPress:function onPress(){return navigation.goBack();},style:styles.backButton,children:\"Go Back\"})]}):_jsx(FlatList,{data:filteredGates,keyExtractor:function keyExtractor(item){return item.id.toString();},renderItem:function renderItem(_ref3){var item=_ref3.item;return _jsx(GateSelector,{gate:item,onSelect:handleSelectGate});},contentContainerStyle:styles.list})]});};var styles=StyleSheet.create({container:{flex:1,backgroundColor:'#f8f9fa'},eventCard:{margin:16,marginBottom:8},eventName:{fontSize:18,color:'#2c3e50'},searchBar:{margin:16,marginTop:8,backgroundColor:'white'},list:{padding:16},centerContainer:{flex:1,justifyContent:'center',alignItems:'center',padding:20},errorText:{fontSize:16,color:'#e74c3c',marginVertical:10,textAlign:'center'},emptyText:{fontSize:16,color:'#7f8c8d',marginVertical:10,textAlign:'center'},loadingText:{marginTop:10,color:'#7f8c8d'},button:{marginTop:20,backgroundColor:'#2c3e50'},backButton:{marginTop:20,borderColor:'#2c3e50'}});export default GateSelectionScreen;","map":{"version":3,"names":["React","useState","useEffect","View","StyleSheet","FlatList","Text","TouchableOpacity","ActivityIndicator","Searchbar","Card","Title","Paragraph","Button","Chip","Feather","useEvent","GateSelector","jsx","_jsx","jsxs","_jsxs","GateSelectionScreen","_ref","navigation","route","_useEvent","selectedEvent","gates","loadGates","selectGate","isLoading","_useState","_useState2","_slicedToArray","searchQuery","setSearchQuery","_useState3","_useState4","filteredGates","setFilteredGates","id","navigate","filterGates","trim","filtered","filter","gate","name","toLowerCase","includes","identifier","handleSelectGate","_ref2","_asyncToGenerator","isEnabled","success","_x","apply","arguments","style","styles","centerContainer","children","size","color","errorText","mode","onPress","button","loadingText","container","eventCard","Content","eventName","Date","date","toLocaleDateString","placeholder","onChangeText","value","searchBar","length","emptyText","goBack","backButton","data","keyExtractor","item","toString","renderItem","_ref3","onSelect","contentContainerStyle","list","create","flex","backgroundColor","margin","marginBottom","fontSize","marginTop","padding","justifyContent","alignItems","marginVertical","textAlign","borderColor"],"sources":["/home/runner/workspace/src/screens/staff/GateSelectionScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { \n  View, \n  StyleSheet, \n  FlatList, \n  Text, \n  TouchableOpacity, \n  ActivityIndicator \n} from 'react-native';\nimport { Searchbar, Card, Title, Paragraph, Button, Chip } from 'react-native-paper';\nimport { Feather } from '@expo/vector-icons';\nimport useEvent from '../../hooks/useEvent';\nimport GateSelector from '../../components/GateSelector';\n\nconst GateSelectionScreen = ({ navigation, route }) => {\n  const { selectedEvent, gates, loadGates, selectGate, isLoading } = useEvent();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filteredGates, setFilteredGates] = useState([]);\n\n  useEffect(() => {\n    if (selectedEvent) {\n      loadGates(selectedEvent.id);\n    } else {\n      // Redirect to event selection if no event is selected\n      navigation.navigate('EventSelection');\n    }\n  }, [selectedEvent]);\n\n  useEffect(() => {\n    if (gates) {\n      filterGates();\n    }\n  }, [gates, searchQuery]);\n\n  const filterGates = () => {\n    if (!searchQuery.trim()) {\n      setFilteredGates(gates);\n    } else {\n      const filtered = gates.filter(gate => \n        gate.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        gate.identifier.toLowerCase().includes(searchQuery.toLowerCase())\n      );\n      setFilteredGates(filtered);\n    }\n  };\n\n  const handleSelectGate = async (gate) => {\n    if (!gate.isEnabled) {\n      return; // Don't allow selection of disabled gates\n    }\n\n    const success = await selectGate(gate);\n    if (success) {\n      // Navigate to scanner screen\n      navigation.navigate('Scanner');\n    }\n  };\n\n  if (!selectedEvent) {\n    return (\n      <View style={styles.centerContainer}>\n        <Feather name=\"alert-circle\" size={50} color=\"#e74c3c\" />\n        <Text style={styles.errorText}>No event selected</Text>\n        <Button \n          mode=\"contained\" \n          onPress={() => navigation.navigate('EventSelection')}\n          style={styles.button}\n        >\n          Select Event\n        </Button>\n      </View>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <View style={styles.centerContainer}>\n        <ActivityIndicator size=\"large\" color=\"#2c3e50\" />\n        <Text style={styles.loadingText}>Loading gates...</Text>\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <Card style={styles.eventCard}>\n        <Card.Content>\n          <Title style={styles.eventName}>{selectedEvent.name}</Title>\n          <Paragraph>\n            {new Date(selectedEvent.date).toLocaleDateString()}\n          </Paragraph>\n        </Card.Content>\n      </Card>\n\n      <Searchbar\n        placeholder=\"Search gates...\"\n        onChangeText={setSearchQuery}\n        value={searchQuery}\n        style={styles.searchBar}\n      />\n\n      {gates.length === 0 ? (\n        <View style={styles.centerContainer}>\n          <Feather name=\"map-pin\" size={50} color=\"#95a5a6\" />\n          <Text style={styles.emptyText}>No gates available for this event</Text>\n          <Button \n            mode=\"outlined\" \n            onPress={() => navigation.goBack()}\n            style={styles.backButton}\n          >\n            Go Back\n          </Button>\n        </View>\n      ) : (\n        <FlatList\n          data={filteredGates}\n          keyExtractor={(item) => item.id.toString()}\n          renderItem={({ item }) => (\n            <GateSelector\n              gate={item}\n              onSelect={handleSelectGate}\n            />\n          )}\n          contentContainerStyle={styles.list}\n        />\n      )}\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f8f9fa',\n  },\n  eventCard: {\n    margin: 16,\n    marginBottom: 8,\n  },\n  eventName: {\n    fontSize: 18,\n    color: '#2c3e50',\n  },\n  searchBar: {\n    margin: 16,\n    marginTop: 8,\n    backgroundColor: 'white',\n  },\n  list: {\n    padding: 16,\n  },\n  centerContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20,\n  },\n  errorText: {\n    fontSize: 16,\n    color: '#e74c3c',\n    marginVertical: 10,\n    textAlign: 'center',\n  },\n  emptyText: {\n    fontSize: 16,\n    color: '#7f8c8d',\n    marginVertical: 10,\n    textAlign: 'center',\n  },\n  loadingText: {\n    marginTop: 10,\n    color: '#7f8c8d',\n  },\n  button: {\n    marginTop: 20,\n    backgroundColor: '#2c3e50',\n  },\n  backButton: {\n    marginTop: 20,\n    borderColor: '#2c3e50',\n  }\n});\n\nexport default GateSelectionScreen;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}