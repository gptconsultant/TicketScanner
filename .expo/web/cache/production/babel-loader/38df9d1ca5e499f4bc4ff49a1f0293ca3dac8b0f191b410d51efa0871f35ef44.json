{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{PermissionStatus,UnavailabilityError}from'expo-modules-core';function getUserMedia(constraints){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){return navigator.mediaDevices.getUserMedia(constraints);}var getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||function(){var error=new Error('Permission unimplemented');error.code=0;error.name='NotAllowedError';throw error;};return new Promise(function(resolve,reject){getUserMedia.call(navigator,constraints,resolve,reject);});}function handleGetUserMediaError(_ref){var message=_ref.message;if(message==='Permission dismissed'){return{status:PermissionStatus.UNDETERMINED,expires:'never',canAskAgain:true,granted:false};}else{return{status:PermissionStatus.DENIED,expires:'never',canAskAgain:true,granted:false};}}function handleRequestPermissionsAsync(){return _handleRequestPermissionsAsync.apply(this,arguments);}function _handleRequestPermissionsAsync(){_handleRequestPermissionsAsync=_asyncToGenerator(function*(){try{yield getUserMedia({video:true});return{status:PermissionStatus.GRANTED,expires:'never',canAskAgain:true,granted:true};}catch(_ref2){var message=_ref2.message;return handleGetUserMediaError({message:message});}});return _handleRequestPermissionsAsync.apply(this,arguments);}function handlePermissionsQueryAsync(){return _handlePermissionsQueryAsync.apply(this,arguments);}function _handlePermissionsQueryAsync(){_handlePermissionsQueryAsync=_asyncToGenerator(function*(){var _navigator,_navigator$permission;if(!((_navigator=navigator)!=null&&(_navigator$permission=_navigator.permissions)!=null&&_navigator$permission.query)){throw new UnavailabilityError('expo-barcode-scanner','navigator.permissions API is not available');}var _yield$navigator$perm=yield navigator.permissions.query({name:'camera'}),state=_yield$navigator$perm.state;switch(state){case'prompt':return{status:PermissionStatus.UNDETERMINED,expires:'never',canAskAgain:true,granted:false};case'granted':return{status:PermissionStatus.GRANTED,expires:'never',canAskAgain:true,granted:true};case'denied':return{status:PermissionStatus.DENIED,expires:'never',canAskAgain:true,granted:false};}});return _handlePermissionsQueryAsync.apply(this,arguments);}export default{get BarCodeType(){return{code39mod43:'code39mod43',code138:'code138',interleaved2of5:'interleaved2of5',aztec:'aztec',ean13:'ean13',ean8:'ean8',qr:'qr',pdf417:'pdf417',upc_e:'upc_e',datamatrix:'datamatrix',code39:'code39',code93:'code93',itf14:'itf14',codabar:'codabar',code128:'code128',upc_a:'upc_a'};},get Type(){return{front:'front',back:'back'};},requestPermissionsAsync:function(){var _requestPermissionsAsync=_asyncToGenerator(function*(){return handleRequestPermissionsAsync();});function requestPermissionsAsync(){return _requestPermissionsAsync.apply(this,arguments);}return requestPermissionsAsync;}(),getPermissionsAsync:function(){var _getPermissionsAsync=_asyncToGenerator(function*(){return handlePermissionsQueryAsync();});function getPermissionsAsync(){return _getPermissionsAsync.apply(this,arguments);}return getPermissionsAsync;}()};","map":{"version":3,"names":["PermissionStatus","UnavailabilityError","getUserMedia","constraints","navigator","mediaDevices","webkitGetUserMedia","mozGetUserMedia","error","Error","code","name","Promise","resolve","reject","call","handleGetUserMediaError","_ref","message","status","UNDETERMINED","expires","canAskAgain","granted","DENIED","handleRequestPermissionsAsync","_handleRequestPermissionsAsync","apply","arguments","_asyncToGenerator","video","GRANTED","_ref2","handlePermissionsQueryAsync","_handlePermissionsQueryAsync","_navigator","_navigator$permission","permissions","query","_yield$navigator$perm","state","BarCodeType","code39mod43","code138","interleaved2of5","aztec","ean13","ean8","qr","pdf417","upc_e","datamatrix","code39","code93","itf14","codabar","code128","upc_a","Type","front","back","requestPermissionsAsync","_requestPermissionsAsync","getPermissionsAsync","_getPermissionsAsync"],"sources":["/home/runner/workspace/node_modules/expo-barcode-scanner/src/ExpoBarCodeScannerModule.web.ts"],"sourcesContent":["import { PermissionResponse, PermissionStatus, UnavailabilityError } from 'expo-modules-core';\n\nfunction getUserMedia(constraints: MediaStreamConstraints): Promise<MediaStream> {\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n\n  // First get ahold of the legacy getUserMedia, if present\n  const getUserMedia =\n    // TODO: this method is deprecated, migrate to https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n    navigator.getUserMedia ||\n    navigator.webkitGetUserMedia ||\n    navigator.mozGetUserMedia ||\n    function () {\n      const error: any = new Error('Permission unimplemented');\n      error.code = 0;\n      error.name = 'NotAllowedError';\n      throw error;\n    };\n\n  return new Promise((resolve, reject) => {\n    getUserMedia.call(navigator, constraints, resolve, reject);\n  });\n}\n\nfunction handleGetUserMediaError({ message }: { message: string }): PermissionResponse {\n  // name: NotAllowedError\n  // code: 0\n  if (message === 'Permission dismissed') {\n    return {\n      status: PermissionStatus.UNDETERMINED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: false,\n    };\n  } else {\n    return {\n      status: PermissionStatus.DENIED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: false,\n    };\n  }\n}\n\nasync function handleRequestPermissionsAsync(): Promise<PermissionResponse> {\n  try {\n    await getUserMedia({\n      video: true,\n    });\n    return {\n      status: PermissionStatus.GRANTED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: true,\n    };\n  } catch ({ message }) {\n    return handleGetUserMediaError({ message });\n  }\n}\n\nasync function handlePermissionsQueryAsync(): Promise<PermissionResponse> {\n  if (!navigator?.permissions?.query) {\n    throw new UnavailabilityError(\n      'expo-barcode-scanner',\n      'navigator.permissions API is not available'\n    );\n  }\n\n  const { state } = await navigator.permissions.query({ name: 'camera' });\n  switch (state) {\n    case 'prompt':\n      return {\n        status: PermissionStatus.UNDETERMINED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: false,\n      };\n    case 'granted':\n      return {\n        status: PermissionStatus.GRANTED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: true,\n      };\n    case 'denied':\n      return {\n        status: PermissionStatus.DENIED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: false,\n      };\n  }\n}\n\nexport default {\n  get BarCodeType() {\n    return {\n      code39mod43: 'code39mod43',\n      code138: 'code138',\n      interleaved2of5: 'interleaved2of5',\n      aztec: 'aztec',\n      ean13: 'ean13',\n      ean8: 'ean8',\n      qr: 'qr',\n      pdf417: 'pdf417',\n      upc_e: 'upc_e',\n      datamatrix: 'datamatrix',\n      code39: 'code39',\n      code93: 'code93',\n      itf14: 'itf14',\n      codabar: 'codabar',\n      code128: 'code128',\n      upc_a: 'upc_a',\n    };\n  },\n  get Type() {\n    return { front: 'front', back: 'back' };\n  },\n  async requestPermissionsAsync(): Promise<PermissionResponse> {\n    return handleRequestPermissionsAsync();\n  },\n  async getPermissionsAsync(): Promise<PermissionResponse> {\n    return handlePermissionsQueryAsync();\n  },\n};\n"],"mappings":"uEAAA,OAA6BA,gBAAgB,CAAEC,mBAAmB,KAAQ,mBAAmB,CAE7F,QAAS,CAAAC,YAAYA,CAACC,WAAmC,EACvD,GAAIC,SAAS,CAACC,YAAY,EAAID,SAAS,CAACC,YAAY,CAACH,YAAY,CAAE,CACjE,MAAO,CAAAE,SAAS,CAACC,YAAY,CAACH,YAAY,CAACC,WAAW,CAAC,C,CAQzD,GAAM,CAAAD,YAAY,CAEhBE,SAAS,CAACF,YAAY,EACtBE,SAAS,CAACE,kBAAkB,EAC5BF,SAAS,CAACG,eAAe,EACzB,WACE,GAAM,CAAAC,KAAK,CAAQ,GAAI,CAAAC,KAAK,CAAC,0BAA0B,CAAC,CACxDD,KAAK,CAACE,IAAI,CAAG,CAAC,CACdF,KAAK,CAACG,IAAI,CAAG,iBAAiB,CAC9B,KAAM,CAAAH,KAAK,CACb,CAAC,CAEH,MAAO,IAAI,CAAAI,OAAO,CAAC,SAACC,OAAO,CAAEC,MAAM,CAAI,CACrCZ,YAAY,CAACa,IAAI,CAACX,SAAS,CAAED,WAAW,CAAEU,OAAO,CAAEC,MAAM,CAAC,CAC5D,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAE,uBAAuBA,CAAAC,IAAA,CAAiC,IAA9B,CAAAC,OAAO,CAAAD,IAAA,CAAPC,OAAO,CAGxC,GAAIA,OAAO,GAAK,sBAAsB,CAAE,CACtC,MAAO,CACLC,MAAM,CAAEnB,gBAAgB,CAACoB,YAAY,CACrCC,OAAO,CAAE,OAAO,CAChBC,WAAW,CAAE,IAAI,CACjBC,OAAO,CAAE,K,CACV,C,CACF,IAAM,CACL,MAAO,CACLJ,MAAM,CAAEnB,gBAAgB,CAACwB,MAAM,CAC/BH,OAAO,CAAE,OAAO,CAChBC,WAAW,CAAE,IAAI,CACjBC,OAAO,CAAE,K,CACV,C,CAEL,CAAC,QAEc,CAAAE,6BAA6BA,CAAA,SAAAC,8BAAA,CAAAC,KAAA,MAAAC,SAAA,YAAAF,+BAAA,EAAAA,8BAAA,CAAAG,iBAAA,CAA5C,WAA4C,CAC1C,GAAI,CACF,KAAM,CAAA3B,YAAY,CAAC,CACjB4B,KAAK,CAAE,I,CACR,CAAC,CACF,MAAO,CACLX,MAAM,CAAEnB,gBAAgB,CAAC+B,OAAO,CAChCV,OAAO,CAAE,OAAO,CAChBC,WAAW,CAAE,IAAI,CACjBC,OAAO,CAAE,I,CACV,C,CACD,MAAAS,KAAA,CAAoB,IAAX,CAAAd,OAAO,CAAAc,KAAA,CAAPd,OAAO,CAChB,MAAO,CAAAF,uBAAuB,CAAC,CAAEE,OAAO,CAAPA,OAAO,CAAE,CAAC,C,CAE/C,CAAC,SAAAQ,8BAAA,CAAAC,KAAA,MAAAC,SAAA,WAEc,CAAAK,2BAA2BA,CAAA,SAAAC,4BAAA,CAAAP,KAAA,MAAAC,SAAA,YAAAM,6BAAA,EAAAA,4BAAA,CAAAL,iBAAA,CAA1C,WAA0C,KAAAM,UAAA,CAAAC,qBAAA,CACxC,GAAI,GAAAD,UAAA,CAAC/B,SAAS,UAAAgC,qBAAA,CAATD,UAAA,CAAWE,WAAW,SAAtBD,qBAAA,CAAwBE,KAAK,EAAE,CAClC,KAAM,IAAI,CAAArC,mBAAmB,CAC3B,sBAAsB,CACtB,4CAA4C,CAC7C,C,CAGH,IAAAsC,qBAAA,MAAwB,CAAAnC,SAAS,CAACiC,WAAW,CAACC,KAAK,CAAC,CAAE3B,IAAI,CAAE,QAAQ,CAAE,CAAC,CAA/D6B,KAAK,CAAAD,qBAAA,CAALC,KAAK,CACb,OAAQA,KAAK,EACX,IAAK,QAAQ,CACX,MAAO,CACLrB,MAAM,CAAEnB,gBAAgB,CAACoB,YAAY,CACrCC,OAAO,CAAE,OAAO,CAChBC,WAAW,CAAE,IAAI,CACjBC,OAAO,CAAE,K,CACV,CACH,IAAK,SAAS,CACZ,MAAO,CACLJ,MAAM,CAAEnB,gBAAgB,CAAC+B,OAAO,CAChCV,OAAO,CAAE,OAAO,CAChBC,WAAW,CAAE,IAAI,CACjBC,OAAO,CAAE,I,CACV,CACH,IAAK,QAAQ,CACX,MAAO,CACLJ,MAAM,CAAEnB,gBAAgB,CAACwB,MAAM,CAC/BH,OAAO,CAAE,OAAO,CAChBC,WAAW,CAAE,IAAI,CACjBC,OAAO,CAAE,K,CACV,C,CAEP,CAAC,SAAAW,4BAAA,CAAAP,KAAA,MAAAC,SAAA,GAED,cAAe,CACb,GAAI,CAAAa,WAAWA,CAAA,EACb,MAAO,CACLC,WAAW,CAAE,aAAa,CAC1BC,OAAO,CAAE,SAAS,CAClBC,eAAe,CAAE,iBAAiB,CAClCC,KAAK,CAAE,OAAO,CACdC,KAAK,CAAE,OAAO,CACdC,IAAI,CAAE,MAAM,CACZC,EAAE,CAAE,IAAI,CACRC,MAAM,CAAE,QAAQ,CAChBC,KAAK,CAAE,OAAO,CACdC,UAAU,CAAE,YAAY,CACxBC,MAAM,CAAE,QAAQ,CAChBC,MAAM,CAAE,QAAQ,CAChBC,KAAK,CAAE,OAAO,CACdC,OAAO,CAAE,SAAS,CAClBC,OAAO,CAAE,SAAS,CAClBC,KAAK,CAAE,O,CACR,CACH,CAAC,CACD,GAAI,CAAAC,IAAIA,CAAA,EACN,MAAO,CAAEC,KAAK,CAAE,OAAO,CAAEC,IAAI,CAAE,MAAM,CAAE,CACzC,CAAC,CACKC,uBAAuB,gBAAAC,wBAAA,CAAAjC,iBAAA,aAC3B,MAAO,CAAAJ,6BAA6B,EAAE,CACxC,CAAC,UAFK,CAAAoC,uBAAuBA,CAAA,SAAAC,wBAAA,CAAAnC,KAAA,MAAAC,SAAA,SAAvB,CAAAiC,uBAAuB,KAGvBE,mBAAmB,gBAAAC,oBAAA,CAAAnC,iBAAA,aACvB,MAAO,CAAAI,2BAA2B,EAAE,CACtC,CAAC,UAFK,CAAA8B,mBAAmBA,CAAA,SAAAC,oBAAA,CAAArC,KAAA,MAAAC,SAAA,SAAnB,CAAAmC,mBAAmB,I,CAG1B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}